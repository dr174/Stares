import base64
exec(base64.b64decode('ZnJvbSB0ZWxldGhvbiBpbXBvcnQgVGVsZWdyYW1DbGllbnQsIGV2ZW50cwpmcm9tIHRlbGV0aG9uLnRsLnR5cGVzIGltcG9ydCBVc2VyCmltcG9ydCBhc3luY2lvCmltcG9ydCBkYXRldGltZQppbXBvcnQgcHl0egoKIyAqKiog2KfYs9iq2KjYr9mEINmH2LDZhyDYp9mE2YLZitmFINio2YLZitmF2YMg2KfZhNmB2LnZhNmK2KkgKioqCmFwaV9pZCA9ICcyNjU5MDA1OScgCmFwaV9oYXNoID0gJ2VhYzgwMjQzNmMyZjFkNmEwMGFhMWY2NDk3OWU4YThmJwpzZXNzaW9uX25hbWUgPSAnbXlfdXNlcmJvdF9zZXNzaW9uJyAgIyDYp9iz2YUg2YTZhdmE2YEg2KfZhNis2YTYs9ipCgojINil2YbYtNin2KEg2YPYp9im2YYg2KfZhNi52YXZitmECmNsaWVudCA9IFRlbGVncmFtQ2xpZW50KHNlc3Npb25fbmFtZSwgYXBpX2lkLCBhcGlfaGFzaCkKCiMg2YXYqti62YrYsdin2Kog2YTYrdin2YTYqSDYp9mE2LPYp9i52KkKY2xvY2tfcnVubmluZyA9IEZhbHNlCmNsb2NrX3Rhc2sgPSBOb25lCm9yaWdpbmFsX2ZpcnN0X25hbWUgPSBOb25lCgojINmC2KfZhdmI2LMg2YTYqtit2YjZitmEINin2YTYo9ix2YLYp9mFINin2YTYudin2K/ZitipINil2YTZiSDYp9mE2KPYsdmC2KfZhSDYp9mE2YXYstiu2LHZgdipINin2YTZhdi32YTZiNio2KkKZGVjb3JhdGl2ZV9kaWdpdHMgPSB7CiAgICAnMCc6ICfwnZ+OJywgJzEnOiAn8J2fjycsICcyJzogJ/Cdn5AnLCAnMyc6ICfwnZ+RJywgJzQnOiAn8J2fkicsCiAgICAnNSc6ICfwnZ+TJywgJzYnOiAn8J2flCcsICc3JzogJ/Cdn5UnLCAnOCc6ICfwnZ+WJywgJzknOiAn8J2flycKfQoKIyDYr9in2YTYqSDZhNiq2K3ZiNmK2YQg2LPZhNiz2YTYqSDZhti12YrYqSDYqtit2KrZiNmKINi52YTZiSDYo9ix2YLYp9mFINil2YTZiSDYp9mE2KPYsdmC2KfZhSDYp9mE2YXYstiu2LHZgdipCmRlZiBjb252ZXJ0X3RvX2RlY29yYXRpdmVfZGlnaXRzKHRleHQpOgogICAgcmV0dXJuICcnLmpvaW4oZGVjb3JhdGl2ZV9kaWdpdHMuZ2V0KGNoYXIsIGNoYXIpIGZvciBjaGFyIGluIHRleHQpCgojINiv2KfZhNipINi62YrYsSDZhdiq2LLYp9mF2YbYqSDZhNiq2K3Yr9mK2Ksg2KfZhNin2LPZhSDYqNi02YPZhCDYr9mI2LHZigphc3luYyBkZWYgdXBkYXRlX2Nsb2NrX25hbWVfdGFzaygpOgogICAgZ2xvYmFsIGNsb2NrX3J1bm5pbmcsIG9yaWdpbmFsX2ZpcnN0X25hbWUKICAgIGlyYXFfdHogPSBweXR6LnRpbWV6b25lKCdBc2lhL0JhZ2hkYWQnKSAgIyDYp9mE2YXZhti32YLYqSDYp9mE2LLZhdmG2YrYqSDZhNmE2LnYsdin2YIKCiAgICB3aGlsZSBjbG9ja19ydW5uaW5nOgogICAgICAgIHRyeToKICAgICAgICAgICAgbm93X2lyYXEgPSBkYXRldGltZS5kYXRldGltZS5ub3coaXJhcV90eikKICAgICAgICAgICAgdGltZV9zdHIgPSBub3dfaXJhcS5zdHJmdGltZSgnJUk6JU0gJXAnKQogICAgICAgICAgICBkZWNvcmF0aXZlX3RpbWVfc3RyID0gY29udmVydF90b19kZWNvcmF0aXZlX2RpZ2l0cyh0aW1lX3N0cikKICAgICAgICAgICAgbmV3X2ZpcnN0X25hbWUgPSBmIntkZWNvcmF0aXZlX3RpbWVfc3RyfSB8INin2YTYudix2KfZgiIKCiAgICAgICAgICAgIGF3YWl0IGNsaWVudChVcGRhdGVQcm9maWxlUmVxdWVzdChmaXJzdF9uYW1lPW5ld19maXJzdF9uYW1lKSkKICAgICAgICAgICAgYXdhaXQgYXN5bmNpby5zbGVlcCgzMCkgICMg2KrYrdiv2YrYqyDZg9mEIDMwINir2KfZhtmK2KkKCiAgICAgICAgZXhjZXB0IGFzeW5jaW8uQ2FuY2VsbGVkRXJyb3I6CiAgICAgICAgICAgIHByaW50KCLYqtmFINil2YrZgtin2YEg2YXZh9mF2Kkg2KrYrdiv2YrYqyDYp9mE2LPYp9i52KkiKQogICAgICAgICAgICBicmVhawoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYi2K3Yr9irINiu2LfYoyDYo9ir2YbYp9ihINiq2K3Yr9mK2Ksg2KfZhNin2LPZhToge2V9IikKICAgICAgICAgICAgYXdhaXQgYXN5bmNpby5zbGVlcCg2MCkKCiAgICAjINin2LPYqti52KfYr9ipINin2YTYp9iz2YUg2KfZhNij2LXZhNmKINi52YbYryDYp9mE2KrZiNmC2YEKICAgIGlmIG9yaWdpbmFsX2ZpcnN0X25hbWUgaXMgbm90IE5vbmU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBhd2FpdCBjbGllbnQoVXBkYXRlUHJvZmlsZVJlcXVlc3QoZmlyc3RfbmFtZT1vcmlnaW5hbF9maXJzdF9uYW1lKSkKICAgICAgICAgICAgcHJpbnQoZiLYqtmFINin2LPYqti52KfYr9ipINin2YTYp9iz2YUg2KfZhNij2LXZhNmKOiB7b3JpZ2luYWxfZmlyc3RfbmFtZX0iKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiLYrdiv2Ksg2K7Yt9ijINij2KvZhtin2KEg2KfYs9iq2LnYp9iv2Kkg2KfZhNin2LPZhToge2V9IikKCiMgLS0tIEhhbmRsZXJzINmE2YTYo9mI2KfZhdixIC0tLQoKQGNsaWVudC5vbihldmVudHMuTmV3TWVzc2FnZShwYXR0ZXJuPXInXC7Yp9mE2KfZiNin2YXYsSQnLCBvdXRnb2luZz1UcnVlKSkKYXN5bmMgZGVmIHNob3dfY29tbWFuZHMoZXZlbnQpOgogICAgY29tbWFuZHNfdGV4dCA9ICIiIgotLS0tLS0tLS0tLS0tLS0tLS3igKItLS0tLS0tLS0tLS0tLS0tLQou2YUxIDog2KPZiNin2YXZgNixINin2YTYs9in2LnYqQou2YUyIDog2KPZiNin2YXZgNixINin2YTYrdi42LEKLS0tLS0tLS0tLS0tLS0tLS0t4oCiLS0tLS0tLS0tLS0tLS0tLS0KIiIiCiAgICBhd2FpdCBldmVudC5lZGl0KGNvbW1hbmRzX3RleHQpCgpAY2xpZW50Lm9uKGV2ZW50cy5OZXdNZXNzYWdlKHBhdHRlcm49cidcLtmFMSQnLCBvdXRnb2luZz1UcnVlKSkKYXN5bmMgZGVmIHNob3dfY2xvY2tfY29tbWFuZHMoZXZlbnQpOgogICAgY29tbWFuZHNfdGV4dCA9ICIiIgotLS0tLS0tLS0tLS0tLS0tRklOQUwgVXNlcmJvdC0tLS0tLS0tLS0tLS0tLS0tCtin2YjYp9mF2LEg2KfZhNiz2KfYudipCi7Yp9mE2LPYp9i52KkK2LPYqtmB2LnZhCDYp9mE2LPYp9i52Kkg2KzZhtioINin2LPZhdmDINi52YTZiSDYp9mE2LnYsdin2YIKLtin2YTYs9in2LnYqV/ZiNmC2YEK2LPZitmI2YLZgSDYp9mE2LPYp9i52KkKLS0tLS0tLS0tLS0tLS0tLUZJTkFMIFVzZXJib3QtLS0tLS0tLS0tLS0tLS0tLQoiIiIKICAgIGF3YWl0IGV2ZW50LmVkaXQoY29tbWFuZHNfdGV4dCkKCkBjbGllbnQub24oZXZlbnRzLk5ld01lc3NhZ2UocGF0dGVybj1yJ1wu2YUyJCcsIG91dGdvaW5nPVRydWUpKQphc3luYyBkZWYgc2hvd19iYW5fY29tbWFuZHMoZXZlbnQpOgogICAgY29tbWFuZHNfdGV4dCA9ICIiIgotLS0tLS0tLS0tLS0tLS0tRklOQUwgVXNlcmJvdC0tLS0tLS0tLS0tLS0tLS0tCi7Yrdi42LHZhwrYs9mK2K3YuNix2Ycg2YXZhiDYp9mE2K7Yp9i1Ci7ZgdmD2YcK2LPZitmB2YMg2KfZhNit2LjYsQotLS0tLS0tLS0tLS0tLS0tRklOQUwgVXNlcmJvdC0tLS0tLS0tLS0tLS0tLS0tCiIiIgogICAgYXdhaXQgZXZlbnQuZWRpdChjb21tYW5kc190ZXh0KQoKQGNsaWVudC5vbihldmVudHMuTmV3TWVzc2FnZShwYXR0ZXJuPXInXC7Yp9mE2LPYp9i52KkkJywgb3V0Z29pbmc9VHJ1ZSkpCmFzeW5jIGRlZiBzdGFydF9jbG9jayhldmVudCk6CiAgICBnbG9iYWwgY2xvY2tfcnVubmluZywgY2xvY2tfdGFzaywgb3JpZ2luYWxfZmlyc3RfbmFtZQogICAgCiAgICBpZiBjbG9ja19ydW5uaW5nOgogICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoItin2YTYs9in2LnYqSDYqti52YXZhCDYqNin2YTZgdi52YQhIikKICAgICAgICByZXR1cm4KICAgIAogICAgdHJ5OgogICAgICAgIG1lID0gYXdhaXQgY2xpZW50LmdldF9tZSgpCiAgICAgICAgb3JpZ2luYWxfZmlyc3RfbmFtZSA9IG1lLmZpcnN0X25hbWUgb3IgIiIKICAgICAgICBjbG9ja19ydW5uaW5nID0gVHJ1ZQogICAgICAgIGNsb2NrX3Rhc2sgPSBhc3luY2lvLmNyZWF0ZV90YXNrKHVwZGF0ZV9jbG9ja19uYW1lX3Rhc2soKSkKICAgICAgICBhd2FpdCBldmVudC5lZGl0KCLYqtmFINiq2YHYudmK2YQg2KfZhNiz2KfYudipINmB2Yog2KfZhNin2LPZhSDYp9mE2KPZiNmEIikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYi2K3Yr9irINiu2LfYozoge2V9IikKCkBjbGllbnQub24oZXZlbnRzLk5ld01lc3NhZ2UocGF0dGVybj1yJ1wu2KfZhNiz2KfYudipX9mI2YLZgSQnLCBvdXRnb2luZz1UcnVlKSkKYXN5bmMgZGVmIHN0b3BfY2xvY2soZXZlbnQpOgogICAgZ2xvYmFsIGNsb2NrX3J1bm5pbmcsIGNsb2NrX3Rhc2sKICAgIAogICAgaWYgbm90IGNsb2NrX3J1bm5pbmc6CiAgICAgICAgYXdhaXQgZXZlbnQuZWRpdCgi2KfZhNiz2KfYudipINi62YrYsSDZhdmB2LnZhNipINij2LXZhNin2YshIikKICAgICAgICByZXR1cm4KICAgIAogICAgY2xvY2tfcnVubmluZyA9IEZhbHNlCiAgICBpZiBjbG9ja190YXNrOgogICAgICAgIGNsb2NrX3Rhc2suY2FuY2VsKCkKICAgIGF3YWl0IGV2ZW50LmVkaXQoItiq2YUg2KXZitmC2KfZgSDYp9mE2LPYp9i52Kkg2YjYpdiy2KfZhNipINin2YTYp9iz2YUg2KfZhNij2YjZhCIpCgpAY2xpZW50Lm9uKGV2ZW50cy5OZXdNZXNzYWdlKHBhdHRlcm49cidcLtit2LjYsdmHJCcsIG91dGdvaW5nPVRydWUpKQphc3luYyBkZWYgYmFuX3VzZXIoZXZlbnQpOgogICAgaWYgbm90IGV2ZW50LmlzX3JlcGx5OgogICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoItmK2KzYqCDYp9mE2LHYryDYudmE2Ykg2LHYs9in2YTYqSDYp9mE2YXYs9iq2K7Yr9mFINmE2K3YuNix2YciKQogICAgICAgIHJldHVybgogICAgCiAgICByZXBseV9tc2cgPSBhd2FpdCBldmVudC5nZXRfcmVwbHlfbWVzc2FnZSgpCiAgICB1c2VyX2lkID0gcmVwbHlfbXNnLnNlbmRlcl9pZAogICAgCiAgICB0cnk6CiAgICAgICAgYXdhaXQgY2xpZW50KEJsb2NrUmVxdWVzdCh1c2VyX2lkKSkKICAgICAgICBhd2FpdCBldmVudC5lZGl0KCLYp9mE2YXYs9iq2K7Yr9mFINiq2YUg2K3YuNix2Ycg2YXZhiDYp9mE2K/Ysdiv2LTYqSDZhdi52YMg2YHZiiDYp9mE2K7Yp9i1IikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBhd2FpdCBldmVudC5lZGl0KGYi2YHYtNmEINmB2Yog2K3YuNixINin2YTZhdiz2KrYrtiv2YU6IHtlfSIpCgpAY2xpZW50Lm9uKGV2ZW50cy5OZXdNZXNzYWdlKHBhdHRlcm49cidcLtmB2YPZhyQnLCBvdXRnb2luZz1UcnVlKSkKYXN5bmMgZGVmIHVuYmFuX3VzZXIoZXZlbnQpOgogICAgaWYgbm90IGV2ZW50LmlzX3JlcGx5OgogICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoItmK2KzYqCDYp9mE2LHYryDYudmE2Ykg2LHYs9in2YTYqSDYp9mE2YXYs9iq2K7Yr9mFINmE2YHZgyDYrdi42LHZhyIpCiAgICAgICAgcmV0dXJuCiAgICAKICAgIHJlcGx5X21zZyA9IGF3YWl0IGV2ZW50LmdldF9yZXBseV9tZXNzYWdlKCkKICAgIHVzZXJfaWQgPSByZXBseV9tc2cuc2VuZGVyX2lkCiAgICAKICAgIHRyeToKICAgICAgICBhd2FpdCBjbGllbnQoVW5ibG9ja1JlcXVlc3QodXNlcl9pZCkpCiAgICAgICAgYXdhaXQgZXZlbnQuZGVsZXRlKCkgICMg2K3YsNmBINin2YTYsdiz2KfZhNipINio2K/ZiNmGINil2LHYs9in2YQg2KrYo9mD2YrYrwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGF3YWl0IGV2ZW50LmVkaXQoZiLZgdi02YQg2YHZiiDZgdmDINit2LjYsSDYp9mE2YXYs9iq2K7Yr9mFOiB7ZX0iKQoKIyDYqti02LrZitmEINin2YTYudmF2YrZhAphc3luYyBkZWYgbWFpbigpOgogICAgYXdhaXQgY2xpZW50LnN0YXJ0KCkKICAgIHByaW50KCLYqtmFINiq2LTYutmK2YQg2KfZhNio2YjYqiDYqNmG2KzYp9itISIpCiAgICBhd2FpdCBjbGllbnQucnVuX3VudGlsX2Rpc2Nvbm5lY3RlZCgpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgY2xpZW50Lmxvb3AucnVuX3VudGlsX2NvbXBsZXRlKG1haW4oKSk=').decode())
